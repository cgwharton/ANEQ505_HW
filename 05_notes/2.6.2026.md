Load the class node:

```
sinteractive --reservation=aneq505 --time=01:00:00 --partition=amilan --nodes=1 --ntasks=6 --qos=normal
```

Load your Qiime environment:
```
module purge  

module load qiime2/2024.10_amplicon
```

Let's navigate to the correct place. Use `cd` to move into your **decomp****_tutorial** folder. Use `pwd` to make sure you're in the correct place.

```
cd /scratch/alpine/$USER/decomp_tutorial
  
pwd
```

**Create directories for the different analyses so you can keep your files organized:**

```
mkdir slurm

mkdir taxonomy

mkdir tree

mkdir taxaplots

mkdir dada2

mkdir demux

mkdir core_metrics
```

qza = qiime artifact so qiime can read through it

**Create a directory for the manifest and import the manifest files (we made them for you):** 

In your study you would need to construct the manifest file yourself, 

```
mkdir manifest  

cd manifest  

cp /pl/active/courses/2025_summer/CSU_2025/q2_workshop_final/QIIME2/manifest_run2.txt .

cp /pl/active/courses/2025_summer/CSU_2025/q2_workshop_final/QIIME2/manifest_run3.txt .
```

Move out of the manifest directory:
```
cd ../
```

**Copy the demultiplex reads into your analysis directory:**

```
cp -r /pl/active/courses/2025_summer/CSU_2025/q2_workshop_final/QIIME2/reads_run2 .

cp -r /pl/active/courses/2025_summer/CSU_2025/q2_workshop_final/QIIME2/reads_run3 .
```



Let's take a look at the data we just imported, we can do this by moving into the reads folder, and typing ls
```
cd reads_run2

ls
```
these are the individual sample fastq files!

```
cd ../
```

**Import data into QIIME2:**
# run the import command to generate a qiime2 readable artifact for the reads, save the demux results in the demux folder.
```
qiime tools import \  
--type "SampleData[PairedEndSequencesWithQuality]" \  
--input-format PairedEndFastqManifestPhred33V2 \  
--input-path manifest/manifest_run2.txt \  
--output-path demux/demux_run2.qza

qiime tools import \  
--type "SampleData[PairedEndSequencesWithQuality]" \  
--input-format PairedEndFastqManifestPhred33V2 \  
--input-path manifest/manifest_run3.txt \  
--output-path demux/demux_run3.qza
```

**Check Data Quality:** 

The first important step of data analysis is to check the data quality. Now that we've gotten our data into QIIME2 it's simple to get a visualization that we can use to evaluate our sample quality.  

# generate a demux visualization file  
```
cd demux  
  
#run2  
qiime demux summarize \  
--i-data demux_run2.qza \  
--o-visualization demux_run2.qzv  
  
#run3  
qiime demux summarize \  
--i-data demux_run3.qza \  
--o-visualization demux_run3.qzv  
```

would keep full seq length for run3

Just like above, transfer this output file to your local computer and visualize it in [view.qiime2.orgLinks to an external site.](http://view.qiime2.org/ "(opens in a new window)"). 

**Questions to Answer with this Output:**

- What is the per-sample sequencing count?
	-  number of sequence reads for that specific sample
- Which sample had the fewest sequences per sample? The most?
	- extraction controls
- How many samples were in this run?
	- 
- How does the quality look?
	-  run 2 quality ok, run3 quality better
- Does your data look the exact same as your neighbors?
	- everyones will be slightly different bc sub-sampling 
		- "random sampling of 10000 out of **1636911** sequences"
			- 1636911 could be 234567
- How long are the reads? 
	- 
- **Where would you trim and/or truncate these sequences to maintain the highest quality data?**

**Binned Quality Scores**

Some sequencing platforms (e.g. newer Illumina instruments like the MiSeq i100) do not report **individual Phred quality scores** for each base. Instead, they use **binned quality scores**, where ranges of quality values are grouped and reported as a single representative score. This reduces file size and improves data compression, but it changes how quality information is encoded in your FASTQ files.

Rather than seeing the full range of Phred scores (e.g., 0–41), bases are assigned to one of **four quality bins**, which are reported as:

**2** → very low quality bases

**9** → low quality bases

**23** → moderate quality bases

**38** → high quality bases

Each of these values represents a _range_ of underlying Phred scores rather than an exact estimate of sequencing accuracy. For example, a base reported with a quality score of 38 may represent any base whose true quality falls within the highest bin.

